<!DOCTYPE html> <html> <head> <script type="text/javascript"> var host = 'www.serverlessconsultants.com'; if (host == window.location.host && window.location.protocol != 'https:') { window.location.protocol = 'https'; } </script> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content=""> <meta name="author" content="Serverless Directory"> <meta name="msvalidate.01" content="0C81C6A5BD3BAF86F4730D8C4A9BF223" /> <meta name="google-site-verification" content=""> <title>Serverless Wsgi - Serverless Plugin Directory</title> <!-- Google+ Authorship --> <link rel="author" href="Serverless Directory"> <link rel="publisher" href="Serverless Directory"> <!-- Canonical --> <link rel="canonical" href="https://www.serverlessconsultants.com/plugins/serverless-wsgi/"> <!-- Fonts --> <link href='https://fonts.googleapis.com/css?family=Libre+Franklin:400,100,100italic,200,200italic,300,300italic,400italic,500,600,500italic,600italic,700,700italic,800,900,800italic,900italic' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=Patrick+Hand+SC' rel='stylesheet' type='text/css'> <!-- Styles --> <link rel="stylesheet" href=" /css/main.css "> <!-- Feed --> <link rel="alternate" type="application/rss+xml" title="ServerLess Directory" href="https://www.serverlessconsultants.com /feed.xml "> <!-- Fav Icon and Apple Touch Icons --> <link rel="icon" type="image/png" href="/img/favicon.png" sizes="128x128" /> <meta name="application-name" content="ServerLess Directory" /> <!-- Open Graph --> <meta property="og:title" content="Serverless Wsgi - Serverless Plugin Directory"> <meta property="og:site_name" content="ServerLess Directory"> <meta property="og:type" content="website"> <meta property="og:description" content="Open Issue Count: 3, Stargazer Count: 80, Forks Count: 13, Watchers Count: 80."> </head> <script type="text/javascript"> (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 * new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]); a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' ); ga('create', 'UA-61052500-12', 'auto'); ga('send', 'pageview'); </script> <body> <!-- Navigation --> <header class="bg-white w-100 ph3 pv3 pv4-ns ph4-m ph5-l z-999 bb b--light-gray"> <nav class="tc"> <a class="dib no-underline v-mid tc bw1 ba b gold ph1 pv2 outline b--gold" href="/" rel="nofollow"> <div>SRVR</div> <div>LSS</div> </a> <a class="link dim black b f6 f5-ns dib mr3" href="/" title="Serverless Directory">Serverless Directory</a> <a class="link dim gray f6 f5-ns dib mr3" href="/plugins/">Serverless Plugins</a> <a class="link dim gray f6 f5-ns dib mr3" href="/frameworks/">Serverless Frameworks</a> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/consultants/">Serverless Consultants</a> --> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/contact" title="Contact Serverless Frameworks Directory">Contact</a> --> </nav> </header> <div class="mw8 center"> <h1 class="tc ma0">Serverless Wsgi</h1> <div class="tc"> <a rel="nofollow noreferrer noopener" href="https://github.com/logandk/serverless-wsgi"> <img src="https://icon.now.sh/home" alt="homepage icon"> https://github.com/logandk/serverless-wsgi </a> </div> <article class="ph3 ph5-ns"> <h3 class="f6 ma0 pa0 ttu tc tracked">Tracked</h3> <div class="cf tc"> <dl title="NPM Downloads Last Month: 452" class="db tc mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">NPM Downloads Last Month</dd> <dd class="f3 fw6 ml0">452</dd> </dl> <dl title="Open Issue Count: 3" class="fl fn-l w-50 mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Issues</dd> <dd class="f3 fw6 ml0">3</dd> </dl> <dl title="Stargazer Count: 80" class="fl fn-l w-50 dib-l mb0 w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Stars</dd> <dd class="f3 fw6 ml0">80</dd> </dl> <dl title="Forks Count: 13" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title mr5-l"> <dd class="f6 fw4 ml0">Forks</dd> <dd class="f3 fw6 ml0">13</dd> </dl> <dl title="Watchers Count: 80" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title"> <dd class="f6 fw4 ml0">Watchers</dd> <dd class="f3 fw6 ml0">80</dd> </dl> </div> </article> <!-- TODO: FIX THIS --> <div class="cf tc mw6 center dn"> </div> </div> <h3 class="tc">Repo README Contents:</h3> <section class="mw8 center ph3 pv2 overflow-x-scroll ba br3" id="readme-content"> <h1 id="serverless-wsgi">Serverless WSGI</h1> <p><a href="https://nodei.co/npm/serverless-wsgi/"><img src="https://nodei.co/npm/serverless-wsgi.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="npm package" /></a></p> <p><a href="http://www.serverless.com"><img src="http://public.serverless.com/badges/v3.svg" alt="serverless" /></a> <a href="https://travis-ci.org/logandk/serverless-wsgi"><img src="https://travis-ci.org/logandk/serverless-wsgi.png?branch=master" alt="Build Status" /></a> <a href="https://coveralls.io/github/logandk/serverless-wsgi?branch=master"><img src="https://coveralls.io/repos/github/logandk/serverless-wsgi/badge.svg?branch=master" alt="Coverage Status" /></a> <a href="https://david-dm.org/logandk/serverless-wsgi"><img src="https://david-dm.org/logandk/serverless-wsgi.png" alt="Dependency Status" /></a> <a href="https://david-dm.org/logandk/serverless-wsgi?type=dev"><img src="https://david-dm.org/logandk/serverless-wsgi/dev-status.png" alt="Dev Dependency Status" /></a></p> <p>A Serverless v1.x plugin to build your deploy Python WSGI applications using Serverless. Compatible WSGI application frameworks include Flask, Django and Pyramid - for a complete list, see: http://wsgi.readthedocs.io/en/latest/frameworks.html.</p> <h3 id="features">Features</h3> <ul> <li>Transparently converts API Gateway requests to and from standard WSGI requests</li> <li>Supports anything you’d expect from WSGI such as redirects, cookies, file uploads etc.</li> <li>Automatically downloads Python packages that you specify in <code class="highlighter-rouge">requirements.txt</code> and deploys them along with your application</li> <li>Convenient <code class="highlighter-rouge">wsgi serve</code> command for serving your application locally during development</li> </ul> <h2 id="install">Install</h2> <div class="highlighter-rouge"><pre class="highlight"><code>npm install --save serverless-wsgi
</code></pre></div> <p>Add the plugin to your <code class="highlighter-rouge">serverless.yml</code> file and set the WSGI application:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">serverless-wsgi</span>
</code></pre></div> <h2 id="flask-configuration-example">Flask configuration example</h2> <p>This example assumes that you have intialized your application as <code class="highlighter-rouge">app</code> inside <code class="highlighter-rouge">api.py</code>.</p> <div class="highlighter-rouge"><pre class="highlight"><code>project
├── api.py
├── requirements.txt
└── serverless.yml
</code></pre></div> <h3 id="apipy">api.py</h3> <p>A regular Flask application.</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s">"/cats"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cats</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">"Cats"</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="s">"/dogs/&lt;id&gt;"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">dog</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">"Dog"</span>
</code></pre></div> <h3 id="serverlessyml">serverless.yml</h3> <p>Load the plugin and set the <code class="highlighter-rouge">custom.wsgi.app</code> configuration in <code class="highlighter-rouge">serverless.yml</code> to the module path of your Flask application.</p> <p>All functions that will use WSGI need to have <code class="highlighter-rouge">wsgi.handler</code> set as the Lambda handler and use the default <code class="highlighter-rouge">lambda-proxy</code> integration for API Gateway. This configuration example treats API Gateway as a transparent proxy, passing all requests directly to your Flask application, and letting the application handle errors, 404s etc.</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span> <span class="s">example</span>

<span class="s">provider</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">aws</span>
  <span class="s">runtime</span><span class="pi">:</span> <span class="s">python2.7</span>

<span class="s">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">serverless-wsgi</span>

<span class="s">functions</span><span class="pi">:</span>
  <span class="s">api</span><span class="pi">:</span>
    <span class="s">handler</span><span class="pi">:</span> <span class="s">wsgi.handler</span>
    <span class="s">events</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span> <span class="s">ANY /</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span> <span class="s">ANY {proxy+}</span>

<span class="s">custom</span><span class="pi">:</span>
  <span class="s">wsgi</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">api.app</span>
</code></pre></div> <h3 id="requirementstxt">requirements.txt</h3> <p>Add Flask to the application bundle.</p> <div class="highlighter-rouge"><pre class="highlight"><code>Flask==0.12.2
</code></pre></div> <h2 id="deployment">Deployment</h2> <p>Simply run the serverless deploy command as usual:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ sls deploy
Serverless: Packaging Python WSGI handler...
Serverless: Packaging required Python packages...
Serverless: Packaging service...
Serverless: Removing old service versions...
Serverless: Uploading CloudFormation file to S3...
Serverless: Uploading service .zip file to S3...
Serverless: Updating Stack...
Serverless: Checking Stack update progress...
..........
Serverless: Stack update finished...
</code></pre></div> <h2 id="other-frameworks">Other frameworks</h2> <p>Set <code class="highlighter-rouge">custom.wsgi.app</code> in <code class="highlighter-rouge">serverless.yml</code> according to your WSGI callable:</p> <ul> <li>For Pyramid, use <a href="http://docs.pylonsproject.org/projects/pyramid/en/latest/api/config.html#pyramid.config.Configurator.make_wsgi_app">make_wsgi_app</a> to intialize the callable</li> <li>Django is configured for WSGI by default, set the callable to <code class="highlighter-rouge">&lt;project_name&gt;.wsgi.application</code>. See https://docs.djangoproject.com/en/1.10/howto/deployment/wsgi/ for more information.</li> </ul> <h2 id="usage">Usage</h2> <h3 id="automatic-requirement-packaging">Automatic requirement packaging</h3> <p>You’ll need to include any packages that your application uses in the bundle that’s deployed to AWS Lambda. This plugin helps you out by doing this automatically, as long as you specify your required packages in a <code class="highlighter-rouge">requirements.txt</code> file in the root of your Serverless service path:</p> <div class="highlighter-rouge"><pre class="highlight"><code>Flask==0.12.2
requests==2.18.3
</code></pre></div> <p>For more information, see https://pip.readthedocs.io/en/1.1/requirements.html.</p> <p>You can use the requirement packaging functionality of <em>serverless-wsgi</em> without the WSGI handler itself by including the plugin in your <code class="highlighter-rouge">serverless.yml</code> configuration, without specifying the <code class="highlighter-rouge">custom.wsgi.app</code> setting. This will omit the WSGI handler from the package, but include any requirements specified in <code class="highlighter-rouge">requirements.txt</code>.</p> <p>If you don’t want to use automatic requirement packaging you can set <code class="highlighter-rouge">custom.wsgi.packRequirements</code> to false:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">wsgi</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">api.app</span>
    <span class="s">packRequirements</span><span class="pi">:</span> <span class="s">false</span>
</code></pre></div> <p>For a more advanced approach to packaging requirements, consider using https://github.com/UnitedIncome/serverless-python-requirements.</p> <h3 id="python-version">Python version</h3> <p>Python is used for packaging requirements and serving the app when invoking <code class="highlighter-rouge">sls wsgi serve</code>. By default, the current runtime setting is expected to be the name of the Python binary in <code class="highlighter-rouge">PATH</code>, for instance <code class="highlighter-rouge">python3.6</code>. If this is not the name of your Python binary, override it using the <code class="highlighter-rouge">pythonBin</code> option:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">wsgi</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">api.app</span>
    <span class="s">pythonBin</span><span class="pi">:</span> <span class="s">python3</span>
</code></pre></div> <h3 id="local-server">Local server</h3> <p>For convenience, a <code class="highlighter-rouge">sls wsgi serve</code> command is provided to run your WSGI application locally. This command requires the <code class="highlighter-rouge">werkzeug</code> Python package to be installed, and acts as a simple wrapper for starting werkzeug’s built-in HTTP server.</p> <p>By default, the server will start on port 5000.</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ sls wsgi serve
 * Running on http://localhost:5000/ (Press CTRL+C to quit)
 * Restarting with stat
 * Debugger is active!
</code></pre></div> <p>Configure the port using the <code class="highlighter-rouge">-p</code> parameter:</p> <div class="highlighter-rouge"><pre class="highlight"><code>$ sls wsgi serve -p 8000
 * Running on http://localhost:8000/ (Press CTRL+C to quit)
 * Restarting with stat
 * Debugger is active!
</code></pre></div> <h3 id="explicit-routes">Explicit routes</h3> <p>If you’d like to be explicit about which routes and HTTP methods should pass through to your application, see the following example:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span> <span class="s">example</span>

<span class="s">provider</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">aws</span>
  <span class="s">runtime</span><span class="pi">:</span> <span class="s">python2.7</span>

<span class="s">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">serverless-wsgi</span>

<span class="s">functions</span><span class="pi">:</span>
  <span class="s">api</span><span class="pi">:</span>
    <span class="s">handler</span><span class="pi">:</span> <span class="s">wsgi.handler</span>
    <span class="s">events</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span>
          <span class="s">path</span><span class="pi">:</span> <span class="s">cats</span>
          <span class="s">method</span><span class="pi">:</span> <span class="s">get</span>
          <span class="s">integration</span><span class="pi">:</span> <span class="s">lambda-proxy</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span>
          <span class="s">path</span><span class="pi">:</span> <span class="s">dogs/{id}</span>
          <span class="s">method</span><span class="pi">:</span> <span class="s">get</span>
          <span class="s">integration</span><span class="pi">:</span> <span class="s">lambda-proxy</span>

<span class="s">custom</span><span class="pi">:</span>
  <span class="s">wsgi</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">api.app</span>
</code></pre></div> <h3 id="custom-domain-names">Custom domain names</h3> <p>If you use custom domain names with API Gateway, you might have a base path that is at the beginning of your path, such as the stage (<code class="highlighter-rouge">/dev</code>, <code class="highlighter-rouge">/stage</code>, <code class="highlighter-rouge">/prod</code>). You can pass in an <code class="highlighter-rouge">API_GATEWAY_BASE_PATH</code> environment variable so your WSGI app can handle it correctly.</p> <p>The example below uses the <a href="https://github.com/amplify-education/serverless-domain-manager">serverless-domain-manager</a> plugin to handle custom domains in API Gateway:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span> <span class="s">example</span>

<span class="s">provider</span><span class="pi">:</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">aws</span>
  <span class="s">runtime</span><span class="pi">:</span> <span class="s">python2.7</span>
  <span class="s">environment</span><span class="pi">:</span>
    <span class="s">API_GATEWAY_BASE_PATH</span><span class="pi">:</span> <span class="s">${self:custom.customDomain.basePath}</span>

<span class="s">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">serverless-wsgi</span>
  <span class="pi">-</span> <span class="s">serverless-domain-manager</span>

<span class="s">functions</span><span class="pi">:</span>
  <span class="s">api</span><span class="pi">:</span>
    <span class="s">handler</span><span class="pi">:</span> <span class="s">wsgi.handler</span>
    <span class="s">events</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span> <span class="s">ANY /</span>
      <span class="pi">-</span> <span class="s">http</span><span class="pi">:</span> <span class="s">ANY {proxy+}</span>

<span class="s">custom</span><span class="pi">:</span>
  <span class="s">wsgi</span><span class="pi">:</span>
    <span class="s">app</span><span class="pi">:</span> <span class="s">api.app</span>
  <span class="s">customDomain</span><span class="pi">:</span>
    <span class="s">basePath</span><span class="pi">:</span> <span class="s">${opt:stage}</span>
    <span class="s">domainName</span><span class="pi">:</span> <span class="s">mydomain.name.com</span>
    <span class="s">stage</span><span class="pi">:</span> <span class="s">${opt:stage}</span>
    <span class="s">createRoute53Record</span><span class="pi">:</span> <span class="s">true</span>
</code></pre></div> <h1 id="thanks">Thanks</h1> <p>Thanks to <a href="https://github.com/Miserlou/Zappa">Zappa</a>, which has been both the inspiration and source of several implementations that went into this project.</p> <p>Thanks to <a href="https://github.com/awslabs/chalice">chalice</a> for the requirement packaging implementation.</p> </section> <footer class="cf w-100"> <div class="cover bg-left bg-center-l pv5" style="background-image: url(/img/bg.png)"> <form action="//tachyonstemplates.us16.list-manage.com/subscribe/post?u=3ff847fac68c99ba4cbf378be&amp;id=8eb026def6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="center pa3" target="_blank" novalidate> <div> <h3 class="pa0 f3 f2-ns mb3 mt0 white tc">Want more Serverless?</h3> <h5 class="pa0 f4 f3-ns mb3 white tc">Subscribe to our mailing list to receive an update when new items arrive!</h5> <div class="cf mw7 center"> <label class="clip" for="email-address">Email Address</label> <input placeholder="Your Email Address" type="email" name="EMAIL" class="f6 f5-l input-reset bn fl black-80 bg-white pa3 lh-solid w-100 w-75-m w-80-l br2-ns br--left-ns"> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3ff847fac68c99ba4cbf378be_8eb026def6" tabindex="-1" value=""></div> <input class="f6 f5-l button-reset fl pv3 tc bn bg-animate bg-black-70 hover-bg-black white pointer w-100 w-25-m w-20-l br2-ns br--right-ns" name="subscribe" type="submit" value="Subscribe"> </div> </div> </form> </div> <div class="pb4 pt2 ph3 ph5-ns tc lh-copy"> <a class="pv2 db ph3 dim" href="/">Serverless Directory - Plugins, Frameworks, Consultants</a> <a class="pv2 db ph3 dim" href="/frameworks/">Serverless Frameworks Directory</a> <a class="pv2 db ph3 dim" href="/plugins/">Serverless Plugin Directory</a> <a class="pv2 db ph3 dim" href="/plugins/topics/">Serverless Plugin Topics</a> </div> </footer> <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script> <!-- keeping this here for prosperity --> </body> </html>
