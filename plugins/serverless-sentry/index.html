<!DOCTYPE html> <html> <head> <script type="text/javascript"> var host = 'www.serverlessconsultants.com'; if (host == window.location.host && window.location.protocol != 'https:') { window.location.protocol = 'https'; } </script> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content=""> <meta name="author" content="Serverless Directory"> <meta name="msvalidate.01" content="0C81C6A5BD3BAF86F4730D8C4A9BF223" /> <meta name="google-site-verification" content=""> <title>Serverless Sentry Plugin - Serverless Plugin Directory</title> <!-- Google+ Authorship --> <link rel="author" href="Serverless Directory"> <link rel="publisher" href="Serverless Directory"> <!-- Canonical --> <link rel="canonical" href="https://www.serverlessconsultants.com/plugins/serverless-sentry/"> <!-- Fonts --> <link href='https://fonts.googleapis.com/css?family=Libre+Franklin:400,100,100italic,200,200italic,300,300italic,400italic,500,600,500italic,600italic,700,700italic,800,900,800italic,900italic' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=Patrick+Hand+SC' rel='stylesheet' type='text/css'> <!-- Styles --> <link rel="stylesheet" href=" /css/main.css "> <!-- Feed --> <link rel="alternate" type="application/rss+xml" title="ServerLess Directory" href="https://www.serverlessconsultants.com /feed.xml "> <!-- Fav Icon and Apple Touch Icons --> <link rel="icon" type="image/png" href="/img/favicon.png" sizes="128x128" /> <meta name="application-name" content="ServerLess Directory" /> <!-- Open Graph --> <meta property="og:title" content="Serverless Sentry Plugin - Serverless Plugin Directory"> <meta property="og:site_name" content="ServerLess Directory"> <meta property="og:type" content="website"> <meta property="og:description" content="Open Issue Count: 8, Stargazer Count: 30, Forks Count: 3, Watchers Count: 30."> </head> <script type="text/javascript"> (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 * new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]); a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' ); ga('create', 'UA-61052500-12', 'auto'); ga('send', 'pageview'); </script> <body> <!-- Navigation --> <header class="bg-white w-100 ph3 pv3 pv4-ns ph4-m ph5-l z-999 bb b--light-gray"> <nav class="tc"> <a class="dib no-underline v-mid tc bw1 ba b gold ph1 pv2 outline b--gold" href="/" rel="nofollow"> <div>SRVR</div> <div>LSS</div> </a> <a class="link dim black b f6 f5-ns dib mr3" href="/" title="Serverless Directory">Serverless Directory</a> <a class="link dim gray f6 f5-ns dib mr3" href="/plugins/">Serverless Plugins</a> <a class="link dim gray f6 f5-ns dib mr3" href="/frameworks/">Serverless Frameworks</a> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/consultants/">Serverless Consultants</a> --> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/contact" title="Contact Serverless Frameworks Directory">Contact</a> --> </nav> </header> <div class="mw8 center"> <h1 class="tc ma0">Serverless Sentry Plugin</h1> <div class="tc"> <a rel="nofollow noreferrer noopener" href="https://github.com/arabold/serverless-sentry-plugin"> <img src="https://icon.now.sh/home" alt="homepage icon"> https://github.com/arabold/serverless-sentry-plugin </a> </div> <article class="ph3 ph5-ns"> <h3 class="f6 ma0 pa0 ttu tc tracked">Tracked</h3> <div class="cf tc"> <dl title="NPM Downloads Last Month: 187" class="db tc mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">NPM Downloads Last Month</dd> <dd class="f3 fw6 ml0">187</dd> </dl> <dl title="Open Issue Count: 8" class="fl fn-l w-50 mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Issues</dd> <dd class="f3 fw6 ml0">8</dd> </dl> <dl title="Stargazer Count: 30" class="fl fn-l w-50 dib-l mb0 w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Stars</dd> <dd class="f3 fw6 ml0">30</dd> </dl> <dl title="Forks Count: 3" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title mr5-l"> <dd class="f6 fw4 ml0">Forks</dd> <dd class="f3 fw6 ml0">3</dd> </dl> <dl title="Watchers Count: 30" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title"> <dd class="f6 fw4 ml0">Watchers</dd> <dd class="f3 fw6 ml0">30</dd> </dl> </div> </article> <!-- TODO: FIX THIS --> <div class="cf tc mw6 center dn"> </div> </div> <h3 class="tc">Repo README Contents:</h3> <section class="mw8 center ph3 pv2 overflow-x-scroll ba br3" id="readme-content"> <h1 id="Ô∏è-serverless-sentry-plugin">‚ö°Ô∏è Serverless Sentry Plugin</h1> <p><a href="http://www.serverless.com"><img src="http://public.serverless.com/badges/v3.svg" alt="serverless" /></a> <a href="https://www.npmjs.com/package/serverless-sentry"><img src="https://img.shields.io/npm/v/serverless-sentry.svg" alt="npm" /></a> <a href="https://github.com/arabold/serverless-sentry-plugin/blob/master/LICENSE"><img src="https://img.shields.io/github/license/arabold/serverless-sentry-plugin.svg" alt="license" /></a> <a href="https://www.npmjs.com/package/serverless-sentry"><img src="https://img.shields.io/david/arabold/serverless-sentry-plugin.svg" alt="dependencies" /></a></p> <h2 id="about">About</h2> <p>This Serverless plugin simplifies integration of <a href="https://sentry.io">Sentry</a> with the popular <a href="https://serverless.com">Serverless Framework</a> and AWS Lambda.</p> <p>Currently we support <strong>Node.js 4.3.2</strong>, <strong>Node.js 6.10.2</strong> as well as <strong>Python</strong> running on AWS Lambda. Other platforms can be added by providing a respective integration library. Pull Requests are welcome!</p> <h3 id="what-is-raven-and-sentry">What is Raven and Sentry?</h3> <p>It‚Äôs a bit confusing, but <em>Raven</em> is the official name of the error reporting SDK that will forward errors, exceptions and messages to the <em>Sentry</em> server. For more details of what Raven and Sentry actually is, refer to the official Sentry documentation: https://docs.sentry.io/.</p> <p>The Serverless Sentry plugin and library is not affiliated with either Sentry or Serverless but developed independently and in my spare time.</p> <h3 id="benefits">Benefits</h3> <ul> <li>Easy to use.</li> <li>Integrates with <a href="http://www.serverless.com">Serverless Framework</a> for AWS Lambda.</li> <li>Wraps your Node.js and Python code with <a href="http://sentry.io">Sentry</a> error capturing.</li> <li>Forwards any errors returned by your AWS Lambda function to Sentry.</li> <li>Warn if your code is about to hit the execution timeout limit.</li> <li>Warn if your Lambda function is low on memory.</li> <li>Catches and reports unhandled exceptions.</li> <li>Automated release creation and deployment notifications for Sentry.</li> <li>Serverless, Sentry and as well as this library are all Open Source. Yay! üéâ</li> </ul> <h2 id="overview">Overview</h2> <p>Sentry integration splits into two components:</p> <ol> <li>This plugin which simplifies installation with the Serverless Framework</li> <li>The <a href="https://github.com/arabold/serverless-sentry-lib">serverless-sentry-lib</a> which performs the runtime monitoring and error reporting.</li> </ol> <p>For a detailed overview of how to use the <a href="https://github.com/arabold/serverless-sentry-lib">serverless-sentry-lib</a> refer to its <a href="https://github.com/arabold/serverless-sentry-lib/blob/master/README.md">README.md</a>.</p> <h2 id="installation">Installation</h2> <ul> <li>Install the <code class="highlighter-rouge">node-raven</code> module as a <em>production dependency</em> (so it gets packaged together with your source code): <div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm install --save raven
</code></pre></div> </li> <li>Install the <a href="https://github.com/arabold/serverless-sentry-lib">serverless-sentry-lib</a> as a <em>production dependency</em> as well: <div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm install --save serverless-sentry-lib
</code></pre></div> </li> <li>Install this plugin as a <em>development dependency</em> (you don‚Äôt want to package it with your release artifacts): <div class="language-bash highlighter-rouge"><pre class="highlight"><code>npm install --save-dev serverless-sentry
</code></pre></div> </li> <li>Check out the examples below how to integrate it with your project by updating <code class="highlighter-rouge">serverless.yml</code> as well as your Lambda handler code.</li> </ul> <h2 id="usage">Usage</h2> <p>The <a href="https://github.com/arabold/serverless-sentry-plugin">Serverless Sentry Plugin</a> allows configuration of the library through the <code class="highlighter-rouge">serverless.yml</code> and will create release and deployment information for you (if wanted). This is the recommended way of using the <code class="highlighter-rouge">serverless-sentry-lib</code> library.</p> <h3 id="Ô∏è-step-1-load-the-plugin">‚ñ∂Ô∏è Step 1: Load the Plugin</h3> <p>The plugin determines your environment during deployment and adds the <code class="highlighter-rouge">SENTRY_DSN</code> environment variables to your Lambda function. All you need to do is to load the plugin and set the <code class="highlighter-rouge">dsn</code> configuration option as follows:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span> <span class="s">my-serverless-project</span>
<span class="s">provider</span><span class="pi">:</span>
  <span class="c1"># ...</span>
<span class="s">plugins</span><span class="pi">:</span>
  <span class="s">serverless-sentry</span>
<span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span> <span class="c1"># URL provided by Sentry</span>
</code></pre></div> <h3 id="Ô∏è-step-2-wrap-your-function-handler-code">‚ñ∂Ô∏è Step 2: Wrap Your Function Handler Code</h3> <p>The actual reporting to Sentry happens in platform specific libraries. Currently only Node.js and Python are supported.</p> <p>Each library provides a <code class="highlighter-rouge">RavenLambdaWrapper</code> helper that act as decorators around your original AWS Lambda handler code and is configured via this plugin or manually through environment variables.</p> <p>For more details refer to the individual libraries‚Äô repositories:</p> <ul> <li>Node.js: <a href="https://github.com/arabold/serverless-sentry-lib">serverless-sentry-lib</a></li> <li>Python: <a href="https://github.com/Netflix-Skunkworks/raven-python-lambda">Netflix-Skunkworks/raven-python-lambda</a></li> </ul> <h4 id="nodejs">Node.js</h4> <p>Import <code class="highlighter-rouge">RavenLambdaWrapper</code> from the <code class="highlighter-rouge">serverless-sentry-lib</code> Node.js module and pass in your <code class="highlighter-rouge">Raven</code> client as shown below - that‚Äôs it. Passing in your own client is necessary to ensure that the wrapper uses the same environment as the rest of your code. In the rare circumstances that this isn‚Äôt desired, you can pass in <code class="highlighter-rouge">null</code> instead.</p> <p><strong>Original Lambda Handler Code Before Adding RavenLambdaWrapper</strong>:</p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s2">"use strict"</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">hello</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="s1">'Go Serverless! Your function executed successfully!'</span><span class="p">,</span> <span class="nx">event</span> <span class="p">});</span>
<span class="p">};</span>
</code></pre></div> <p><strong>New Lambda Handler Code With RavenLambdaWrapper For Sentry Reporting</strong></p> <div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="s2">"use strict"</span><span class="p">;</span>

<span class="kr">const</span> <span class="nx">Raven</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"raven"</span><span class="p">);</span> <span class="c1">// Official `raven` module</span>
<span class="kr">const</span> <span class="nx">RavenLambdaWrapper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"serverless-sentry-lib"</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">hello</span> <span class="o">=</span> <span class="nx">RavenLambdaWrapper</span><span class="p">.</span><span class="nx">handler</span><span class="p">(</span><span class="nx">Raven</span><span class="p">,</span> <span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span> <span class="na">message</span><span class="p">:</span> <span class="s1">'Go Serverless! Your function executed successfully!'</span><span class="p">,</span> <span class="nx">event</span> <span class="p">});</span>
<span class="p">});</span>
</code></pre></div> <p>For more details about the different configuration options available refer to the <a href="https://github.com/arabold/serverless-sentry-lib/blob/master/README.md">serverless-sentry-lib documentation</a>.</p> <h4 id="python-">Python üêç</h4> <p>Import <code class="highlighter-rouge">RavenLambdaWrapper</code> from the <code class="highlighter-rouge">raven-python-lambda</code> module as shown below:</p> <p><strong>Original Lambda Handler Code Before Adding RavenLambdaWrapper</strong>:</p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Go Serverless! Your function executed successfully"</span><span class="p">)</span>
</code></pre></div> <p><strong>New Lambda Handler Code With RavenLambdaWrapper For Sentry Reporting</strong></p> <div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">raven</span> <span class="kn">import</span> <span class="n">Client</span> <span class="c"># Offical `raven` module</span>
<span class="kn">from</span> <span class="nn">raven</span><span class="err">-</span><span class="nn">python</span><span class="err">-</span><span class="nn">lambda</span> <span class="kn">import</span> <span class="n">RavenLambdaWrapper</span>

<span class="nd">@RavenLambdaWrapper</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Go Serverless! Your function executed successfully"</span><span class="p">)</span>
</code></pre></div> <p>For more details about the Python integration refer to official repository at <a href="https://github.com/Netflix-Skunkworks/raven-python-lambda">Netflix-Skunkworks/raven-python-lambda</a></p> <h2 id="plugin-configuration-options">Plugin Configuration Options</h2> <p>Configure the Sentry plugin using the following options in your <code class="highlighter-rouge">serverless.yml</code>:</p> <ul> <li><code class="highlighter-rouge">dsn</code> - Your Sentry project‚Äôs DSN url (required)</li> <li><code class="highlighter-rouge">environment</code> - Explicitly set the Sentry environment (defaults to the Serverless stage)</li> </ul> <h3 id="sentry-api-access">Sentry API access</h3> <p>In order for some features such as releases and deployments to work, you need to grant API access to this plugin by setting the following options:</p> <ul> <li><code class="highlighter-rouge">organization</code> - Organization name</li> <li><code class="highlighter-rouge">project</code> - Project name</li> <li><code class="highlighter-rouge">authToken</code> - API authentication token with <code class="highlighter-rouge">project:write</code> access</li> </ul> <p>üëâ <strong>Important</strong>: You need to make sure you‚Äôre using <a href="https://docs.sentry.io/api/auth/#auth-tokens">Auth Tokens</a> not API Keys, which are deprecated.</p> <h3 id="releases">Releases</h3> <p>Releases are used by Sentry to provide you with additional context when determining the cause of an issue. The plugin can automatically create releases for you and tag all messages accordingly. To find out more about releases in Sentry, refer to the <a href="https://docs.sentry.io/learn/releases/">official documentation</a>.</p> <p>In order to enable release tagging, you need to set the <code class="highlighter-rouge">release</code> option in your <code class="highlighter-rouge">serverless.yml</code>:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span>
    <span class="s">organization</span><span class="pi">:</span> <span class="s">my-sentry-organziation</span>
    <span class="s">project</span><span class="pi">:</span> <span class="s">my-sentry-project</span>
    <span class="s">authToken</span><span class="pi">:</span> <span class="s">my-sentry-api-key</span>
    <span class="s">release</span><span class="pi">:</span>
      <span class="s">version</span><span class="pi">:</span> <span class="s">&lt;RELEASE VERSION&gt;</span>
      <span class="s">refs</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">repository</span><span class="pi">:</span> <span class="s">&lt;REPOSITORY NAME&gt;</span>
          <span class="s">commit</span><span class="pi">:</span> <span class="s">&lt;COMMIT HASH&gt;</span>
          <span class="s">previousCommit</span><span class="pi">:</span> <span class="s">&lt;COMMIT HASH&gt;</span>
</code></pre></div> <ul> <li><code class="highlighter-rouge">version</code> - Set the release version used in Sentry. Use any of the below values: <ul> <li><code class="highlighter-rouge">git</code> - Uses the current git commit hash or tag as release identifier.</li> <li><code class="highlighter-rouge">random</code> - Generates a random release during deployment.</li> <li><code class="highlighter-rouge">true</code> - First tries to determine the release via <code class="highlighter-rouge">git</code> and falls back to <code class="highlighter-rouge">random</code> if Git is not available.</li> <li><code class="highlighter-rouge">false</code> - Disable release versioning.</li> <li>any fixed string - Use a fixed string for the release. Serverless variables are allowed.</li> </ul> </li> <li><code class="highlighter-rouge">refs</code> - If you have set up Sentry to collect commit data, you can use commit refs to associate your commits with your Sentry releases. Refer to the <a href="https://docs.sentry.io/learn/releases/">Sentry Documentation</a> for details about how to use commit refs. If you set your <code class="highlighter-rouge">version</code> to <code class="highlighter-rouge">git</code> (or <code class="highlighter-rouge">true</code>), the <code class="highlighter-rouge">refs</code> options are populated automatically and don‚Äôt need to be set.</li> </ul> <p>If you don‚Äôt specify any refs, you can also use the short notation for <code class="highlighter-rouge">release</code> and simply set it to the desired release version as follows:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span>
    <span class="s">release</span><span class="pi">:</span> <span class="s">&lt;RELEASE VERSION&gt;</span>
</code></pre></div> <p>If you don‚Äôt need or want the plugin to create releases and deployments, you can omit the <code class="highlighter-rouge">authToken</code>, <code class="highlighter-rouge">organization</code> and <code class="highlighter-rouge">project</code> options. Messages and exceptions sent by your Lambda functions will still be tagged with the release version and show up grouped in Sentry nonetheless.</p> <p>üëâ <strong>Pro Tip:</strong> The possibility to use a fixed string in combination with Serverless variables allows you to inject your release version through the command line, e.g. when running on your continuous integration machine.</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span>
    <span class="s">organization</span><span class="pi">:</span> <span class="s">my-sentry-organziation</span>
    <span class="s">project</span><span class="pi">:</span> <span class="s">my-sentry-project</span>
    <span class="s">authToken</span><span class="pi">:</span> <span class="s">my-sentry-api-key</span>
    <span class="s">release</span><span class="pi">:</span>
      <span class="s">version</span><span class="pi">:</span> <span class="s">${opt:sentryVersion}</span>
      <span class="s">refs</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">repository</span><span class="pi">:</span> <span class="s">${opt:sentryRepository}</span>
          <span class="s">commit</span><span class="pi">:</span> <span class="s">${opt:sentryCommit}</span>
</code></pre></div> <p>And then deploy your project using the command line options from above:</p> <div class="language-bash highlighter-rouge"><pre class="highlight"><code>sls deploy --sentryVersion 1.0.0 --sentryRepository foo/bar --sentryCommit 2da95dfb
</code></pre></div> <p>üëâ <strong>Tip when using Sentry with multiple projects:</strong> Releases in Sentry are specific to the organization and can span multiple projects. Take this in consideration when choosing a version name. If your version applies to the current project only, you should prefix it with your project name.</p> <p>If no option for <code class="highlighter-rouge">release</code> is provided, releases and deployments are <em>disabled</em>.</p> <h3 id="enabling-and-disabling-error-reporting-features">Enabling and Disabling Error Reporting Features</h3> <p>In addition you can configure the Sentry error reporting on a service as well as a per-function level. For more details about the individual configuration options see the <a href="https://github.com/arabold/serverless-sentry-lib/blob/master/README.md">serverless-sentry-lib documentation</a>.</p> <ul> <li><code class="highlighter-rouge">autoBreadcrumbs</code> - Automatically create breadcrumbs (see Sentry Raven docs, defaults to <code class="highlighter-rouge">true</code>)</li> <li><code class="highlighter-rouge">filterLocal</code> - Don‚Äôt report errors from local environments (defaults to <code class="highlighter-rouge">true</code>)</li> <li><code class="highlighter-rouge">captureErrors</code> - Capture Lambda errors (defaults to <code class="highlighter-rouge">true</code>)</li> <li><code class="highlighter-rouge">captureUnhandledRejections</code> - Capture unhandled exceptions (defaults to <code class="highlighter-rouge">true</code>)</li> <li><code class="highlighter-rouge">captureMemoryWarnings</code> - Monitor memory usage (defaults to <code class="highlighter-rouge">true</code>)</li> <li><code class="highlighter-rouge">captureTimeoutWarnings</code> - Monitor execution timeouts (defaults to <code class="highlighter-rouge">true</code>)</li> </ul> <h3 id="example-configuration">Example Configuration</h3> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">service</span><span class="pi">:</span> <span class="s">my-serverless-project</span>
<span class="s">provider</span><span class="pi">:</span>
  <span class="c1"># ...</span>
<span class="s">plugins</span><span class="pi">:</span>
  <span class="s">serverless-sentry</span>
<span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span> <span class="c1"># URL provided by Sentry</span>
    <span class="s">captureTimeoutWarnings</span><span class="pi">:</span> <span class="s">false</span> <span class="c1"># disable timeout warnings globally for all functions</span>
<span class="s">functions</span><span class="pi">:</span>
  <span class="s">FuncFoo</span><span class="pi">:</span>
    <span class="s">handler</span><span class="pi">:</span> <span class="s">Foo.handler</span>
    <span class="s">description</span><span class="pi">:</span> <span class="s">Hello World</span>
    <span class="s">sentry</span><span class="pi">:</span>
      <span class="s">captureErrors</span><span class="pi">:</span> <span class="s">false</span> <span class="c1"># Disable error capturing for this specific function only</span>
      <span class="s">captureTimeoutWarnings</span><span class="pi">:</span> <span class="s">true</span> <span class="c1"># Turn timeout warnings back on</span>
  <span class="s">FuncBar</span><span class="pi">:</span>
    <span class="s">handler</span><span class="pi">:</span> <span class="s">Bar.handler</span>
    <span class="s">sentry</span><span class="pi">:</span> <span class="s">false</span> <span class="c1"># completely turn off Sentry reporting</span>
</code></pre></div> <h2 id="troubleshooting">Troubleshooting</h2> <h3 id="no-errors-are-reported-in-sentry">No errors are reported in Sentry</h3> <p>Double check the DSN settings in your <code class="highlighter-rouge">serverless.yml</code> and compare it with what Sentry shows you in your project settings under ‚ÄúClient Keys (DSN)‚Äù. You need a URL in the following format - see the <a href="https://docs.sentry.io/quickstart/#configure-the-dsn">Sentry Quick Start</a>:</p> <div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="err">PROTOCOL</span><span class="p">}</span><span class="err">://</span><span class="p">{</span><span class="err">PUBLIC_KEY</span><span class="p">}</span><span class="err">:</span><span class="p">{</span><span class="err">SECRET_KEY</span><span class="p">}</span><span class="err">@</span><span class="p">{</span><span class="err">HOST</span><span class="p">}</span><span class="err">/</span><span class="p">{</span><span class="err">PATH</span><span class="p">}{</span><span class="err">PROJECT_ID</span><span class="p">}</span><span class="w">
</span></code></pre></div> <p>Also make sure to add the plugin to your plugins list in the <code class="highlighter-rouge">serverless.yml</code>:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">plugins</span><span class="pi">:</span>
  <span class="s">serverless-sentry</span>
<span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span> <span class="c1"># URL provided by Sentry</span>
</code></pre></div> <h3 id="the-plugin-doesnt-create-any-releases-or-deployments">The plugin doesn‚Äôt create any releases or deployments</h3> <p>Make sure to set the <code class="highlighter-rouge">authToken</code>, <code class="highlighter-rouge">organization</code> as well as <code class="highlighter-rouge">project</code> options in your <code class="highlighter-rouge">serverless.yml</code>, and set <code class="highlighter-rouge">release</code> to a non-empty value as shown in the example below:</p> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">plugins</span><span class="pi">:</span>
  <span class="s">serverless-sentry</span>
<span class="s">custom</span><span class="pi">:</span>
  <span class="s">sentry</span><span class="pi">:</span>
    <span class="s">dsn</span><span class="pi">:</span> <span class="s">https://xxxx:yyyy@sentry.io/zzzz</span> <span class="c1"># URL provided by Sentry</span>
    <span class="s">organization</span><span class="pi">:</span> <span class="s">my-sentry-organziation</span>
    <span class="s">project</span><span class="pi">:</span> <span class="s">my-sentry-project</span>
    <span class="s">authToken</span><span class="pi">:</span> <span class="s">my-sentry-api-key</span>
    <span class="s">release</span><span class="pi">:</span> <span class="s">git</span>
</code></pre></div> <h3 id="when-using-raven-in-my-code-exception-logs-are-missing-details-or-an-error-is-thrown-during-runtime">When using Raven in my code, exception logs are missing details or an error is thrown during runtime</h3> <p>This typically happens if you forgot to pass in the original Raven instance to the <code class="highlighter-rouge">RavenLambdaWrapper</code>. If you pass in <code class="highlighter-rouge">null</code> instead, then the <code class="highlighter-rouge">serverless-sentry-lib</code> will ultimately use a different instance of Raven than the rest of your code. This is typically not what you want. Make sure to pass in the Raven instance during initialization of the <code class="highlighter-rouge">RavenLambdaWrapper</code> as shown in the examples above.</p> <h3 id="raven-throws-an-uncaught-error-cannot-read-property-user-of-undefined">Raven throws an uncaught error: Cannot read property ‚Äòuser‚Äô of undefined</h3> <p>Raven is not initialized correctly. If you use <code class="highlighter-rouge">raven-node</code> directly you must either pass in the <code class="highlighter-rouge">Raven</code> class to the <code class="highlighter-rouge">RavenLambdaWrapper.handler()</code> function as shown in step 2 above, or manually initialize your instance of the raven module.</p> <h3 id="im-testing-my-raven-integration-locally-but-no-errors-or-messages-are-reported">I‚Äôm testing my Raven integration locally but no errors or messages are reported</h3> <p>Check out the <code class="highlighter-rouge">filterLocal</code> configuration setting. If you test Raven locally and want to make sure your messages are sent, set this flag to <code class="highlighter-rouge">false</code>. Once done testing, don‚Äôt forget to switch it back to <code class="highlighter-rouge">true</code> as otherwise you‚Äôll spam your Sentry projects with meaningless errors of local code changes.</p> <h2 id="version-history">Version History</h2> <h3 id="100-rc4">1.0.0-rc.4</h3> <ul> <li>Fixed an issue with creating random version numbers</li> </ul> <h3 id="100-rc3">1.0.0-rc.3</h3> <ul> <li>Allow disabling Sentry for specific functions by settings <code class="highlighter-rouge">sentry: false</code> in the <code class="highlighter-rouge">serverless.yml</code>.</li> <li>Added support for the <a href="https://github.com/dherault/serverless-offline">Serverless Offline Plugin</a>.</li> </ul> <h3 id="100-rc2">1.0.0-rc.2</h3> <ul> <li>Fixed an issue with the plugin not being initialized properly when deploying an existing artifact.</li> </ul> <h3 id="100-rc1">1.0.0-rc.1</h3> <ul> <li>First official release of this plugin for use with Serverless 1.x</li> <li>For older versions of this plugin that work with Serverless 0.5, see https://github.com/arabold/serverless-sentry-plugin/tree/serverless-0.5</li> </ul> <h3 id="to-dos">To-Dos</h3> <ul> <li>[ ] Bring back automatic instrumentation of the Lambda code during packaging</li> <li>[ ] Optionally upload external source-maps to Sentry</li> <li>[ ] Provide CLI commands to create releases and perform other operations in Sentry</li> <li>[ ] Ensure all exceptions and messages have been sent to Sentry before returning; see <a href="https://github.com/getsentry/raven-node/issues/338">#338</a>.</li> </ul> </section> <footer class="cf w-100"> <div class="cover bg-left bg-center-l pv5" style="background-image: url(/img/bg.png)"> <form action="//tachyonstemplates.us16.list-manage.com/subscribe/post?u=3ff847fac68c99ba4cbf378be&amp;id=8eb026def6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="center pa3" target="_blank" novalidate> <div> <h3 class="pa0 f3 f2-ns mb3 mt0 white tc">Want more Serverless?</h3> <h5 class="pa0 f4 f3-ns mb3 white tc">Subscribe to our mailing list to receive an update when new items arrive!</h5> <div class="cf mw7 center"> <label class="clip" for="email-address">Email Address</label> <input placeholder="Your Email Address" type="email" name="EMAIL" class="f6 f5-l input-reset bn fl black-80 bg-white pa3 lh-solid w-100 w-75-m w-80-l br2-ns br--left-ns"> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3ff847fac68c99ba4cbf378be_8eb026def6" tabindex="-1" value=""></div> <input class="f6 f5-l button-reset fl pv3 tc bn bg-animate bg-black-70 hover-bg-black white pointer w-100 w-25-m w-20-l br2-ns br--right-ns" name="subscribe" type="submit" value="Subscribe"> </div> </div> </form> </div> <div class="pb4 pt2 ph3 ph5-ns tc lh-copy"> <a class="pv2 db ph3 dim" href="/">Serverless Directory - Plugins, Frameworks, Consultants</a> <a class="pv2 db ph3 dim" href="/frameworks/">Serverless Frameworks Directory</a> <a class="pv2 db ph3 dim" href="/plugins/">Serverless Plugin Directory</a> <a class="pv2 db ph3 dim" href="/plugins/topics/">Serverless Plugin Topics</a> </div> </footer> <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script> <!-- keeping this here for prosperity --> </body> </html>
