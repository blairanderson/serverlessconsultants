<!DOCTYPE html> <html> <head> <script type="text/javascript"> var host = 'www.serverlessconsultants.com'; if (host == window.location.host && window.location.protocol != 'https:') { window.location.protocol = 'https'; } </script> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content=""> <meta name="author" content="Serverless Directory"> <meta name="msvalidate.01" content="0C81C6A5BD3BAF86F4730D8C4A9BF223" /> <meta name="google-site-verification" content=""> <title>Serverless Package Python Functions - Serverless Plugin Directory</title> <!-- Google+ Authorship --> <link rel="author" href="Serverless Directory"> <link rel="publisher" href="Serverless Directory"> <!-- Canonical --> <link rel="canonical" href="https://www.serverlessconsultants.com/plugins/serverless-package-python-functions/"> <!-- Fonts --> <link href='https://fonts.googleapis.com/css?family=Libre+Franklin:400,100,100italic,200,200italic,300,300italic,400italic,500,600,500italic,600italic,700,700italic,800,900,800italic,900italic' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=Patrick+Hand+SC' rel='stylesheet' type='text/css'> <!-- Styles --> <link rel="stylesheet" href=" /css/main.css "> <!-- Feed --> <link rel="alternate" type="application/rss+xml" title="ServerLess Directory" href="https://www.serverlessconsultants.com /feed.xml "> <!-- Fav Icon and Apple Touch Icons --> <link rel="icon" type="image/png" href="/img/favicon.png" sizes="128x128" /> <meta name="application-name" content="ServerLess Directory" /> <!-- Open Graph --> <meta property="og:title" content="Serverless Package Python Functions - Serverless Plugin Directory"> <meta property="og:site_name" content="ServerLess Directory"> <meta property="og:type" content="website"> <meta property="og:description" content="Open Issue Count: 4, Stargazer Count: 11, Forks Count: 4, Watchers Count: 11."> </head> <script type="text/javascript"> (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 * new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]); a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' ); ga('create', 'UA-61052500-12', 'auto'); ga('send', 'pageview'); </script> <body> <!-- Navigation --> <header class="bg-white w-100 ph3 pv3 pv4-ns ph4-m ph5-l z-999 bb b--light-gray"> <nav class="tc"> <a class="dib no-underline v-mid tc bw1 ba b gold ph1 pv2 outline b--gold" href="/" rel="nofollow"> <div>SRVR</div> <div>LSS</div> </a> <a class="link dim black b f6 f5-ns dib mr3" href="/" title="Serverless Directory">Serverless Directory</a> <a class="link dim gray f6 f5-ns dib mr3" href="/plugins/">Serverless Plugins</a> <a class="link dim gray f6 f5-ns dib mr3" href="/frameworks/">Serverless Frameworks</a> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/consultants/">Serverless Consultants</a> --> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/contact" title="Contact Serverless Frameworks Directory">Contact</a> --> </nav> </header> <div class="mw8 center"> <h1 class="tc ma0">Serverless Package Python Functions</h1> <div class="tc"> <a rel="nofollow noreferrer noopener" href="https://github.com/ubaniabalogun/serverless-package-python-functions"> <img src="https://icon.now.sh/home" alt="homepage icon"> https://github.com/ubaniabalogun/serverless-package-python-functions </a> </div> <article class="ph3 ph5-ns"> <h3 class="f6 ma0 pa0 ttu tc tracked">Tracked</h3> <div class="cf tc"> <dl title="NPM Downloads Last Month: 1054" class="db tc mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">NPM Downloads Last Month</dd> <dd class="f3 fw6 ml0">1054</dd> </dl> <dl title="Open Issue Count: 4" class="fl fn-l w-50 mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Issues</dd> <dd class="f3 fw6 ml0">4</dd> </dl> <dl title="Stargazer Count: 11" class="fl fn-l w-50 dib-l mb0 w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Stars</dd> <dd class="f3 fw6 ml0">11</dd> </dl> <dl title="Forks Count: 4" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title mr5-l"> <dd class="f6 fw4 ml0">Forks</dd> <dd class="f3 fw6 ml0">4</dd> </dl> <dl title="Watchers Count: 11" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title"> <dd class="f6 fw4 ml0">Watchers</dd> <dd class="f3 fw6 ml0">11</dd> </dl> </div> </article> <!-- TODO: FIX THIS --> <div class="cf tc mw6 center dn"> </div> </div> <h3 class="tc">Repo README Contents:</h3> <section class="mw8 center ph3 pv2 overflow-x-scroll ba br3" id="readme-content"> <h1 id="serverless-package-python-functions">serverless-package-python-functions</h1> <p><a href="http://www.serverless.com"><img src="http://public.serverless.com/badges/v3.svg" alt="serverless" /></a> <a href="https://badge.fury.io/js/serverless-package-python-functions"><img src="https://badge.fury.io/js/serverless-package-python-functions.svg" alt="npm version" /></a></p> <ul> <li><a href="#install">Installation</a></li> <li><a href="#what">What’s it?</a></li> <li><a href="#why">Why do I need it?</a></li> <li><a href="#how">How does it work?</a></li> </ul> <h2 id="installation"><a id="install">Installation</a></h2> <div class="highlighter-rouge"><pre class="highlight"><code>$ npm install --save serverless-package-python-functions
</code></pre></div> <div class="highlighter-rouge"><pre class="highlight"><code># serverless.yml
plugins:
  - serverless-package-python-functions
</code></pre></div> <h2 id="what-is-it"><a id="what">What is it?</a></h2> <p>A Serverless Framework plugin for packaging Python Lambda functions with only the dependencies they need.</p> <h2 id="why-do-i-need-it"><a id="why">Why do I need it?</a></h2> <p>This plugin makes it easy to manage function-level and service-level dependencies for your awesome Python Serverless project</p> <p>Let’s consider the following project structure</p> <div class="highlighter-rouge"><pre class="highlight"><code>your-awesome-project/
├── common_files
│   ├── common1.py
│   └── common2.py
├── function1
│   ├── lambda.py
│   └── requirements.txt # with simplejson library
├── function2
│   ├── lambda.py
│   └── requirements.txt
├── requirements.txt # with requests library
└── serverless.yml
</code></pre></div> <p>This project has:</p> <ul> <li>two functions, <code class="highlighter-rouge">function1</code> and <code class="highlighter-rouge">function2</code>, each with their own <code class="highlighter-rouge">requirements.txt</code> files. function1’s requirements.txt lists the simplejson pip package</li> <li>Code common to both <code class="highlighter-rouge">function1</code> and <code class="highlighter-rouge">function2</code> in a directory named <code class="highlighter-rouge">common_files</code></li> <li>A top-level <code class="highlighter-rouge">requirements.txt</code> file with pip dependencies common to both functions, e.g requests library</li> </ul> <p>This plugin will package your functions into individual zip files that look like:</p> <div class="highlighter-rouge"><pre class="highlight"><code>├── lambda.py # function-level code
├── requirements.txt
├── common1.py # service-level code
├── common2.py
├── simplejson # function-level dependencies
├── simplejson-3.10.0.dist-info
├── requests # service-level dependencies
└── requests-2.13.0.dist-info
</code></pre></div> <p>So that the below code</p> <div class="highlighter-rouge"><pre class="highlight"><code>import common1, common2, requests, simplejson
</code></pre></div> <p>in function1/lambda.py works like works like a charm!</p> <p>The plugin also supports packaging your dependencies using a Docker Image that replicates your cloud providers environment, allowing you easily work with platform-dependent libraries like numpy.</p> <h2 id="how-does-it-work"><a id="how">How does it work?</a></h2> <p>The plugin handles the creation of the <a href="https://serverless.com/framework/docs/providers/aws/guide/packaging#artifact">artifact zip files</a> for your Serverless functions.</p> <p>When <code class="highlighter-rouge">serverless deploy</code> is run, the plugin will:</p> <ol> <li>create a build directory for each function</li> <li>copy the appropriate function-level and service-level code you specify into each function’s build directory</li> <li>Download the appropriate function-level and service-level pip dependencies into each function’s build directory</li> <li>Create zip files of each functions build directory</li> </ol> <p>The Serverless framework will then pickup each zip file and upload it to your provider.</p> <p>Here’s a simple <code class="highlighter-rouge">serverless.yml</code> configuration for this plugin, assuming the project structure above</p> <div class="highlighter-rouge"><pre class="highlight"><code>service: your-awesome-project

plugins:
  - serverless-package-python-functions

custom:
  pkgPyFuncs: # plugin configuration
    buildDir: _build
    requirementsFile: 'requirements.txt'
    globalRequirements:
      - ./requirements.txt
    globalIncludes:
      - ./common_files
    cleanup: true

functions:
  function1:
    name: function1
    handler: lambda.handler
    package:
      include:
        - function1
      artifact: ${self:custom.pkgPyFuncs.buildDir}/function1.zip

  function2:
    name: function2
    handler: lambda.handler
    package:
      include:
        - function2
      artifact: ${self:custom.pkgPyFuncs.buildDir}/function2.zip
</code></pre></div> <p>The plugin configurations are simple:</p> <table> <thead> <tr> <th>Configuration</th> <th>Description</th> <th>Optional?</th> </tr> </thead> <tbody> <tr> <td>buildDir</td> <td>Path to a build directory relative to project root, e.g. build</td> <td>No</td> </tr> <tr> <td>requirementsFile</td> <td>The name of the requirements file used for function-level requirements. All function-level requirements files must use the name specified here.</td> <td>Yes. Defaults to <code class="highlighter-rouge">requirements.txt</code></td> </tr> <tr> <td>globalRequirements</td> <td>A list of paths to files containing service-level pip requirements.</td> <td>Yes</td> </tr> <tr> <td>globalIncludes</td> <td>A list of paths to folders containing service-level code files (i.e. code common to all functions). Only the folders contents will be packaged, not the folder itself. Paths to files are not currently supported.</td> <td>Yes</td> </tr> <tr> <td>useDocker</td> <td>Boolean indicating whether to package pip dependencies using Docker. Set this to true if your project uses platform-specific compiled libraries like numpy. Requires a <a href="https://www.docker.com/get-docker">Docker installation</a>.</td> <td>Yes. Defaults to <code class="highlighter-rouge">false</code></td> </tr> <tr> <td>dockerImage</td> <td>The Docker image to use to compile functions if <code class="highlighter-rouge">useDocker</code> is set to <code class="highlighter-rouge">true</code>. Must be specified as <code class="highlighter-rouge">repository:tag</code>. If the image doesn’t exist on the system, it will be downloaded. The initial download may take some time.</td> <td>Yes. Defaults to <code class="highlighter-rouge">lambci/lambda:build-${provider.runtime}</code></td> </tr> <tr> <td>containerName</td> <td>The desired name for the Docker container.</td> <td>Yes. Defaults to <code class="highlighter-rouge">serverless-package-python-functions</code></td> </tr> </tbody> </table> <p>At the function level, you:</p> <ul> <li>Specify <code class="highlighter-rouge">name</code> to give your function a name. The plugin uses the function’s name as the name of the zip artifact</li> <li>Use <code class="highlighter-rouge">include</code> to specify what function-level files you want to include in your artifact. Simply specifying the path to the function’s folder will include every file in the folder in the function’s zip artifact</li> <li>Use <code class="highlighter-rouge">artifact</code> to tell Serverless where to find the zip artifact. The plugin creates the zip artifact for the function at <code class="highlighter-rouge">buildDir</code>/<code class="highlighter-rouge">name</code>.zip, so using <code class="highlighter-rouge">${self:custom.pkgPyFuncs.buildDir}/[function-name-here].zip</code> is advised.</li> </ul> <p>Now, you may be wondering, doesn’t the <a href="https://serverless.com/framework/docs/providers/aws/guide/packaging#artifact">Serverless documentation say</a>:</p> <blockquote> <p>Serverless won’t zip your service if [artifact] is configured and therefore exclude and include will be ignored. Either you use artifact or include / exclude.</p> </blockquote> <p>Yes, that is correct and is actually awesome! Since Serverless ignores <code class="highlighter-rouge">include</code>/<code class="highlighter-rouge">exclude</code> silently when <code class="highlighter-rouge">artifact</code> is specified, it allows this plugin take advantage of the <code class="highlighter-rouge">include</code> property to provide you with a familiar interface for specifying function-level dependencies. So while this plugin uses <code class="highlighter-rouge">include</code> to determine what goes in your artifact, all Serverless cares about is the artifact that this plugin creates when it executes.</p> <p>The last thing that your keen eye may have noticed from the example <code class="highlighter-rouge">serverless.yml</code> above is that <code class="highlighter-rouge">handler</code> is specified simply as <code class="highlighter-rouge">lambda.handler</code> not <code class="highlighter-rouge">${self:custom.pkgPyFuncs.buildDir}/function/lambda.hadler</code> or <code class="highlighter-rouge">function/lambda.handler</code>. This is because the plugin zips your artifacts such that /path/to/function is the root of the zip file. Combined with the fact that it uses <code class="highlighter-rouge">pip install -t</code> to download pip dependencies directly to the top level of the zip file, this makes imports significantly simpler for your project. Furthermore, since <code class="highlighter-rouge">pip install -t</code> downloads the actual pip package files into a folder, this plugin works without the need for <code class="highlighter-rouge">virtualenv</code></p> </section> <footer class="cf w-100"> <div class="cover bg-left bg-center-l pv5" style="background-image: url(/img/bg.png)"> <form action="//tachyonstemplates.us16.list-manage.com/subscribe/post?u=3ff847fac68c99ba4cbf378be&amp;id=8eb026def6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="center pa3" target="_blank" novalidate> <div> <h3 class="pa0 f3 f2-ns mb3 mt0 white tc">Want more Serverless?</h3> <h5 class="pa0 f4 f3-ns mb3 white tc">Subscribe to our mailing list to receive an update when new items arrive!</h5> <div class="cf mw7 center"> <label class="clip" for="email-address">Email Address</label> <input placeholder="Your Email Address" type="email" name="EMAIL" class="f6 f5-l input-reset bn fl black-80 bg-white pa3 lh-solid w-100 w-75-m w-80-l br2-ns br--left-ns"> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3ff847fac68c99ba4cbf378be_8eb026def6" tabindex="-1" value=""></div> <input class="f6 f5-l button-reset fl pv3 tc bn bg-animate bg-black-70 hover-bg-black white pointer w-100 w-25-m w-20-l br2-ns br--right-ns" name="subscribe" type="submit" value="Subscribe"> </div> </div> </form> </div> <div class="pb4 pt2 ph3 ph5-ns tc lh-copy"> <a class="pv2 db ph3 dim" href="/">Serverless Directory - Plugins, Frameworks, Consultants</a> <a class="pv2 db ph3 dim" href="/frameworks/">Serverless Frameworks Directory</a> <a class="pv2 db ph3 dim" href="/plugins/">Serverless Plugin Directory</a> <a class="pv2 db ph3 dim" href="/plugins/topics/">Serverless Plugin Topics</a> </div> </footer> <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script> <!-- keeping this here for prosperity --> </body> </html>
