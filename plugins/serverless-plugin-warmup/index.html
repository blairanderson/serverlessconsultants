<!DOCTYPE html> <html> <head> <script type="text/javascript"> var host = 'www.serverlessconsultants.com'; if (host == window.location.host && window.location.protocol != 'https:') { window.location.protocol = 'https'; } </script> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content=""> <meta name="author" content="Serverless Directory"> <meta name="msvalidate.01" content="0C81C6A5BD3BAF86F4730D8C4A9BF223" /> <meta name="google-site-verification" content=""> <title>Serverless Plugin Warmup - Serverless Plugin Directory</title> <!-- Google+ Authorship --> <link rel="author" href="Serverless Directory"> <link rel="publisher" href="Serverless Directory"> <!-- Canonical --> <link rel="canonical" href="https://www.serverlessconsultants.com/plugins/serverless-plugin-warmup/"> <!-- Fonts --> <link href='https://fonts.googleapis.com/css?family=Libre+Franklin:400,100,100italic,200,200italic,300,300italic,400italic,500,600,500italic,600italic,700,700italic,800,900,800italic,900italic' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=PT+Sans+Caption:400,700' rel='stylesheet' type='text/css'> <link href='https://fonts.googleapis.com/css?family=Patrick+Hand+SC' rel='stylesheet' type='text/css'> <!-- Styles --> <link rel="stylesheet" href=" /css/main.css "> <!-- Feed --> <link rel="alternate" type="application/rss+xml" title="ServerLess Directory" href="https://www.serverlessconsultants.com /feed.xml "> <!-- Fav Icon and Apple Touch Icons --> <link rel="icon" type="image/png" href="/img/favicon.png" sizes="128x128" /> <meta name="application-name" content="ServerLess Directory" /> <!-- Open Graph --> <meta property="og:title" content="Serverless Plugin Warmup - Serverless Plugin Directory"> <meta property="og:site_name" content="ServerLess Directory"> <meta property="og:type" content="website"> <meta property="og:description" content="Open Issue Count: 4, Stargazer Count: 69, Forks Count: 10, Watchers Count: 69."> </head> <script type="text/javascript"> (function(i, s, o, g, r, a, m) { i['GoogleAnalyticsObject'] = r; (i[r] = i[r] || function() { (i[r].q = i[r].q || []).push(arguments); }), (i[r].l = 1 * new Date()); (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]); a.async = 1; a.src = g; m.parentNode.insertBefore(a, m); })( window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga' ); ga('create', 'UA-61052500-12', 'auto'); ga('send', 'pageview'); </script> <body> <!-- Navigation --> <header class="bg-white w-100 ph3 pv3 pv4-ns ph4-m ph5-l z-999 bb b--light-gray"> <nav class="tc"> <a class="dib no-underline v-mid tc bw1 ba b gold ph1 pv2 outline b--gold" href="/" rel="nofollow"> <div>SRVR</div> <div>LSS</div> </a> <a class="link dim black b f6 f5-ns dib mr3" href="/" title="Serverless Directory">Serverless Directory</a> <a class="link dim gray f6 f5-ns dib mr3" href="/plugins/">Serverless Plugins</a> <a class="link dim gray f6 f5-ns dib mr3" href="/frameworks/">Serverless Frameworks</a> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/consultants/">Serverless Consultants</a> --> <!-- <a class="link dim gray f6 f5-ns dib mr3" href="/contact" title="Contact Serverless Frameworks Directory">Contact</a> --> </nav> </header> <div class="mw8 center"> <h1 class="tc ma0">Serverless Plugin Warmup</h1> <div class="tc"> <a rel="nofollow noreferrer noopener" href="https://github.com/FidelLimited/serverless-plugin-warmup"> <img src="https://icon.now.sh/home" alt="homepage icon"> https://github.com/FidelLimited/serverless-plugin-warmup </a> </div> <article class="ph3 ph5-ns"> <h3 class="f6 ma0 pa0 ttu tc tracked">Tracked</h3> <div class="cf tc"> <dl title="NPM Downloads Last Month: 3806" class="db tc mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">NPM Downloads Last Month</dd> <dd class="f3 fw6 ml0">3806</dd> </dl> <dl title="Open Issue Count: 4" class="fl fn-l w-50 mb0 dib-l w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Issues</dd> <dd class="f3 fw6 ml0">4</dd> </dl> <dl title="Stargazer Count: 69" class="fl fn-l w-50 dib-l mb0 w-auto-l lh-title mr5-l"> <dd class="f6 fw4 ml0">Stars</dd> <dd class="f3 fw6 ml0">69</dd> </dl> <dl title="Forks Count: 10" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title mr5-l"> <dd class="f6 fw4 ml0">Forks</dd> <dd class="f3 fw6 ml0">10</dd> </dl> <dl title="Watchers Count: 69" class="fl fn-l w-50 dib-l w-auto-l mb0 lh-title"> <dd class="f6 fw4 ml0">Watchers</dd> <dd class="f3 fw6 ml0">69</dd> </dl> </div> </article> <!-- TODO: FIX THIS --> <div class="cf tc mw6 center dn"> </div> </div> <h3 class="tc">Repo README Contents:</h3> <section class="mw8 center ph3 pv2 overflow-x-scroll ba br3" id="readme-content"> <h1 id="serverless-warmup-plugin-">Serverless WarmUP Plugin â™¨</h1> <p><a href="http://www.serverless.com"><img src="http://public.serverless.com/badges/v3.svg" alt="serverless" /></a> <a href="https://badge.fury.io/js/serverless-plugin-warmup"><img src="https://badge.fury.io/js/serverless-plugin-warmup.svg" alt="npm version" /></a> <a href="https://www.npmjs.com/package/serverless-plugin-warmup"><img src="https://img.shields.io/npm/dm/serverless-plugin-warmup.svg" alt="npm downloads" /></a> <a href="https://raw.githubusercontent.com/FidelLimited/serverless-plugin-warmup/master/LICENSE"><img src="https://img.shields.io/npm/l/serverless-plugin-warmup.svg" alt="license" /></a></p> <p>Keep your lambdas warm during Winter.</p> <p><strong>Requirements:</strong></p> <ul> <li>Serverless <em>v1.12.x</em> or higher.</li> <li>AWS provider</li> </ul> <h2 id="how-it-works">How it works</h2> <p>WarmUP solves <em>cold starts</em> by creating one schedule event lambda that invokes all the service lambdas you select in a configured time interval (default: 5 minutes) or a specific time, forcing your containers to stay alive.</p> <h2 id="setup">Setup</h2> <p>Install via npm in the root of your Serverless service:</p> <div class="highlighter-rouge"><pre class="highlight"><code>npm install serverless-plugin-warmup --save-dev
</code></pre></div> <ul> <li>Add the plugin to the <code class="highlighter-rouge">plugins</code> array in your Serverless <code class="highlighter-rouge">serverless.yml</code>:</li> </ul> <div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">plugins</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">serverless-plugin-warmup</span>
</code></pre></div> <ul> <li>Add a <code class="highlighter-rouge">warmup</code> property to all functions you want to be warm.</li> </ul> <p>You can enable WarmUp in general:</p> <div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">functions</span><span class="pi">:</span>
  <span class="s">hello</span><span class="pi">:</span>
    <span class="s">warmup</span><span class="pi">:</span> <span class="s">true</span>
</code></pre></div> <p>For a specific stage:</p> <div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">functions</span><span class="pi">:</span>
  <span class="s">hello</span><span class="pi">:</span>
    <span class="s">warmup</span><span class="pi">:</span> <span class="s">production</span>
</code></pre></div> <p>For several stages:</p> <div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">functions</span><span class="pi">:</span>
  <span class="s">hello</span><span class="pi">:</span>
    <span class="s">warmup</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">production</span>
      <span class="pi">-</span> <span class="s">staging</span>
</code></pre></div> <ul> <li>WarmUP to be able to <code class="highlighter-rouge">invoke</code> lambdas requires the following Policy Statement in <code class="highlighter-rouge">iamRoleStatements</code>:</li> </ul> <div class="language-yaml highlighter-rouge"><pre class="highlight"><code><span class="s">iamRoleStatements</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">Effect</span><span class="pi">:</span> <span class="s1">'</span><span class="s">Allow'</span>
    <span class="s">Action</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">lambda:InvokeFunction'</span>
    <span class="s">Resource</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Fn::Join</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">:'</span>
      <span class="pi">-</span> <span class="pi">-</span> <span class="s">arn:aws:lambda</span>
        <span class="pi">-</span> <span class="s">Ref</span><span class="pi">:</span> <span class="s">AWS::Region</span>
        <span class="pi">-</span> <span class="s">Ref</span><span class="pi">:</span> <span class="s">AWS::AccountId</span>
        <span class="pi">-</span> <span class="s">function:${self:service}-${opt:stage, self:provider.stage}-*</span>
</code></pre></div> <p>If using pre-warm, the deployment user also needs a similar policy so it can run the WarmUp lambda.</p> <ul> <li>Add an early callback call when the event source is <code class="highlighter-rouge">serverless-plugin-warmup</code>. You should do this early exit before running your code logic, it will save your execution duration and cost:</li> </ul> <div class="language-javascript highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">.</span><span class="nx">lambdaToWarm</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
  <span class="cm">/** Immediate response for WarmUP plugin */</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">source</span> <span class="o">===</span> <span class="s1">'serverless-plugin-warmup'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'WarmUP - Lambda is warm!'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="s1">'Lambda is warm!'</span><span class="p">)</span>
  <span class="p">}</span>
  
  <span class="p">...</span> <span class="nx">add</span> <span class="nx">lambda</span> <span class="nx">logic</span> <span class="nx">after</span>
<span class="p">}</span>
</code></pre></div> <ul> <li>All done! WarmUP will run on SLS <code class="highlighter-rouge">deploy</code> and <code class="highlighter-rouge">package</code> commands</li> </ul> <h2 id="options">Options</h2> <ul> <li><strong>cleanFolder</strong> (default <code class="highlighter-rouge">true</code>)</li> <li><strong>memorySize</strong> (default <code class="highlighter-rouge">128</code>)</li> <li><strong>name</strong> (default <code class="highlighter-rouge">${service}-${stage}-warmup-plugin</code>)</li> <li><strong>schedule</strong> (default <code class="highlighter-rouge">rate(5 minutes)</code>) - More examples <a href="https://docs.aws.amazon.com/lambda/latest/dg/tutorial-scheduled-events-schedule-expressions.html">here</a>.</li> <li><strong>timeout</strong> (default <code class="highlighter-rouge">10</code> seconds)</li> <li><strong>prewarm</strong> (default <code class="highlighter-rouge">false</code>)</li> </ul> <div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">custom</span><span class="pi">:</span>
  <span class="s">warmup</span><span class="pi">:</span>
    <span class="s">cleanFolder</span><span class="pi">:</span> <span class="s">false,</span>
    <span class="s">memorySize</span><span class="pi">:</span> <span class="s">256</span>
    <span class="s">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">make-them-pop'</span>
    <span class="s">schedule</span><span class="pi">:</span> <span class="s1">'</span><span class="s">cron(0/5</span><span class="nv"> </span><span class="s">8-17</span><span class="nv"> </span><span class="s">?</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">MON-FRI</span><span class="nv"> </span><span class="s">*)'</span> <span class="s">// Run WarmUP every 5 minutes Mon-Fri between 8:00am and 5:55pm (UTC)</span>
    <span class="s">timeout</span><span class="pi">:</span> <span class="s">20</span>
    <span class="s">prewarm</span><span class="pi">:</span> <span class="s">true // Run WarmUp immediately after a deployment</span>
</code></pre></div> <p><strong>Options should be tweaked depending on:</strong></p> <ul> <li>Number of lambdas to warm up</li> <li>Day cold periods</li> <li>Desire to avoid cold lambdas after a deployment</li> </ul> <p><strong>Lambdas invoked by WarmUP will have event source <code class="highlighter-rouge">serverless-plugin-warmup</code>:</strong></p> <div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"Event"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"serverless-plugin-warmup"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div> <h2 id="artifact">Artifact</h2> <p>If you are doing your own <a href="https://serverless.com/framework/docs/providers/aws/guide/packaging#artifact">package artifact</a> set option <code class="highlighter-rouge">cleanFolder</code> to <code class="highlighter-rouge">false</code> and run <code class="highlighter-rouge">serverless package</code>. This will allow you to extract the <code class="highlighter-rouge">warmup</code> NodeJS lambda file from the <code class="highlighter-rouge">_warmup</code> folder and add it in your custom artifact logic.</p> <h2 id="gotchas">Gotchas</h2> <p>If you are deploying to a VPC, you need to use private subnets with a Network Address Translation (NAT) gateway (http://docs.aws.amazon.com/lambda/latest/dg/vpc.html). WarmUp requires this so it can call the other lambdas but this is applicable to any lambda that needs access to the public internet or to any other AWS service.</p> <h2 id="cost">Cost</h2> <p>Lambda pricing <a href="https://aws.amazon.com/lambda/pricing/">here</a>. CloudWatch pricing <a href="https://aws.amazon.com/cloudwatch/pricing/">here</a>. You can use <a href="https://s3.amazonaws.com/lambda-tools/pricing-calculator.html">AWS Lambda Pricing Calculator</a> to check how much will cost you monthly.</p> <h4 id="example">Example</h4> <p>Free Tier not included + Default WarmUP options + 10 lambdas to warm, each with <code class="highlighter-rouge">memorySize = 1024</code> and <code class="highlighter-rouge">duration = 10</code>:</p> <ul> <li>WarmUP: runs 8640 times per month = $0.18</li> <li>10 warm lambdas: each invoked 8640 times per month = $14.4</li> <li>Total = $14.58</li> </ul> <p>CloudWatch costs are not in this example because they are very low.</p> <h2 id="contribute">Contribute</h2> <p>Help us making this plugin better and future proof.</p> <ul> <li>Clone the code</li> <li>Install the dependencies with <code class="highlighter-rouge">npm install</code></li> <li>Create a feature branch <code class="highlighter-rouge">git checkout -b new_feature</code></li> <li>Lint with standard <code class="highlighter-rouge">npm run lint</code></li> </ul> <h2 id="license">License</h2> <p>This software is released under the MIT license. See <a href="LICENSE">the license file</a> for more details.</p> </section> <footer class="cf w-100"> <div class="cover bg-left bg-center-l pv5" style="background-image: url(/img/bg.png)"> <form action="//tachyonstemplates.us16.list-manage.com/subscribe/post?u=3ff847fac68c99ba4cbf378be&amp;id=8eb026def6" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="center pa3" target="_blank" novalidate> <div> <h3 class="pa0 f3 f2-ns mb3 mt0 white tc">Want more Serverless?</h3> <h5 class="pa0 f4 f3-ns mb3 white tc">Subscribe to our mailing list to receive an update when new items arrive!</h5> <div class="cf mw7 center"> <label class="clip" for="email-address">Email Address</label> <input placeholder="Your Email Address" type="email" name="EMAIL" class="f6 f5-l input-reset bn fl black-80 bg-white pa3 lh-solid w-100 w-75-m w-80-l br2-ns br--left-ns"> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups--> <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_3ff847fac68c99ba4cbf378be_8eb026def6" tabindex="-1" value=""></div> <input class="f6 f5-l button-reset fl pv3 tc bn bg-animate bg-black-70 hover-bg-black white pointer w-100 w-25-m w-20-l br2-ns br--right-ns" name="subscribe" type="submit" value="Subscribe"> </div> </div> </form> </div> <div class="pb4 pt2 ph3 ph5-ns tc lh-copy"> <a class="pv2 db ph3 dim" href="/">Serverless Directory - Plugins, Frameworks, Consultants</a> <a class="pv2 db ph3 dim" href="/frameworks/">Serverless Frameworks Directory</a> <a class="pv2 db ph3 dim" href="/plugins/">Serverless Plugin Directory</a> <a class="pv2 db ph3 dim" href="/plugins/topics/">Serverless Plugin Topics</a> </div> </footer> <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script> <!-- keeping this here for prosperity --> </body> </html>
